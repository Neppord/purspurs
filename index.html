<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Try it out</title>
    <style>
        #code-label, #code, #code:focus, #code:focus-visible, #code:focus-within {
            font-family: monospace;
            white-space: pre-wrap;
            border: none;
            box-shadow: none;
            outline: none;
        }
        pre:has(#output) {
            margin-bottom: 0;
        }
    </style>
</head>
<body>
<form id="form">
    <pre><output id="output"></output></pre>
    <label id="code-label" for="code">>>> </label>
    <input id="code" type="text" autocomplete="off" autofocus/>
</form>
<script type="module">
    import * as Interpreter from "./index.js";

    const output = document.getElementById("output");
    const code = document.getElementById("code");

    document.getElementById("code").addEventListener('keydown', function (event) {
        if (event.key === "Enter" && event.ctrlKey) {
            repl()
        }
    });

    function repl() {
        const result = Interpreter.interpret_expr(code.value)
        const tail = ">>> " + code.value + "\n" + Interpreter.print(result) + "\n"
        output.innerText = output.innerText + tail
        code.value = ""
    }

    document.getElementById("form").addEventListener("submit", (event) => {
        event.preventDefault()
        repl();
    })
</script>
</body>
</html>